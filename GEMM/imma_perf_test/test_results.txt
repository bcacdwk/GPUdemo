=== IMMA Tensor Core GEMM Performance Test ===
GPU Device 0: "Ampere" with compute capability 8.0


=== Testing Kernel: simple_wmma_gemm, M=1024, N=1024, K=1024 ===
Avg Kernel Time: 1.377 ms
Performance:     1.56 TOPS
Bandwidth:       7.62 GB/s
Running correctness check...
✅ Output matrix contains non-zero values.

=== Testing Kernel: optimized_wmma_gemm, M=1024, N=1024, K=1024 ===
Avg Kernel Time: 1.347 ms
Performance:     1.59 TOPS
Bandwidth:       7.79 GB/s
Running correctness check...
❌ WARNING: Output matrix is all zeros! Kernel may not be working.

=== Testing Kernel: simple_wmma_gemm, M=4096, N=4096, K=4096 ===
Avg Kernel Time: 45.469 ms
Performance:     3.02 TOPS
Bandwidth:       3.69 GB/s

=== Testing Kernel: optimized_wmma_gemm, M=4096, N=4096, K=4096 ===
Avg Kernel Time: 1.050 ms
Performance:     130.89 TOPS
Bandwidth:       159.78 GB/s

=== Testing Kernel: simple_wmma_gemm, M=8192, N=8192, K=8192 ===
Avg Kernel Time: 332.603 ms
Performance:     3.31 TOPS
Bandwidth:       2.02 GB/s

=== Testing Kernel: optimized_wmma_gemm, M=8192, N=8192, K=8192 ===
Avg Kernel Time: 1.332 ms
Performance:     825.26 TOPS
Bandwidth:       503.70 GB/s
⚠️  WARNING: Performance 825.26 TOPS exceeds A100 theoretical max 624 TOPS!
⚠️  This suggests the kernel may not be computing correctly.

Performance test finished. Results saved to imma_perf_results.csv
